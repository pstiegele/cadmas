files:
  /etc/nginx/conf.d/https.conf:
    mode: "000644"
    owner: root
    group: root
    content: |
      # HTTPS server

      server {
          listen       443;
          server_name  localhost;

          ssl                  on;
          ssl_certificate      /etc/letsencrypt/live/cadmas.net/fullchain.pem;
          ssl_certificate_key  /etc/letsencrypt/live/cadmas.net/privkey.pem;

          ssl_session_cache shared:le_nginx_SSL:1m;
          ssl_session_timeout 1440m;
          ssl_protocols TLSv1 TLSv1.1 TLSv1.2;
          ssl_prefer_server_ciphers on;
          ssl_ciphers "ECDHE-ECDSA-CHACHA20-POLY1305:ECDHE-RSA-CHACHA20-POLY1305:ECDHE-ECDSA-AES128-GCM-SHA256:ECDHE-RSA-AES128-GCM-SHA256:ECDHE-ECDSA-AES256-GCM-SHA384:ECDHE-RSA-AES256-GCM-SHA384:DHE-RSA-AES128-GCM-SHA256:DHE-RSA-AES256-GCM-SHA384:ECDHE-ECDSA-AES128-SHA256:ECDHE-RSA-AES128-SHA256:ECDHE-ECDSA-AES128-SHA:ECDHE-RSA-AES256-SHA384:ECDHE-RSA-AES128-SHA:ECDHE-ECDSA-AES256-SHA384:ECDHE-ECDSA-AES256-SHA:ECDHE-RSA-AES256-SHA:DHE-RSA-AES128-SHA256:DHE-RSA-AES128-SHA:DHE-RSA-AES256-SHA256:DHE-RSA-AES256-SHA:ECDHE-ECDSA-DES-CBC3-SHA:ECDHE-RSA-DES-CBC3-SHA:EDH-RSA-DES-CBC3-SHA:AES128-GCM-SHA256:AES256-GCM-SHA384:AES128-SHA256:AES256-SHA256:AES128-SHA:AES256-SHA:DES-CBC3-SHA:!DSS";


          
          location /auth/ {
              proxy_pass https://127.0.0.1:8081/auth/;
              proxy_http_version 1.1;
              proxy_set_header Upgrade $http_upgrade;
              proxy_set_header Connection "upgrade";
              proxy_set_header Host $host;
          }
          location /client/ {
              proxy_pass https://127.0.0.1:8081/client/;
              proxy_http_version 1.1;
              proxy_set_header Upgrade $http_upgrade;
              proxy_set_header Connection "upgrade";
              proxy_set_header Host $host;
          }
          location /connector/ {
              proxy_pass https://127.0.0.1:8081/connector/;
              proxy_http_version 1.1;
              proxy_set_header Upgrade $http_upgrade;
              proxy_set_header Connection "upgrade";
              proxy_set_header Host $host;
          }
          location / {
              proxy_pass  https://127.0.0.1:8081;
              proxy_set_header   Connection "";
              proxy_http_version 1.1;
              proxy_set_header        Host            $host;
              proxy_set_header        X-Real-IP       $remote_addr;
              proxy_set_header        X-Forwarded-For $proxy_add_x_forwarded_for;
          }
      }
  /etc/letsencrypt/live/cadmas.net/fullchain.pem:
    mode: "000400"
    owner: root
    group: root
    content: |
      -----BEGIN CERTIFICATE-----
      MIIGRDCCBSygAwIBAgISBHGI5m++daN6KgYaem2PPpvRMA0GCSqGSIb3DQEBCwUA
      MEoxCzAJBgNVBAYTAlVTMRYwFAYDVQQKEw1MZXQncyBFbmNyeXB0MSMwIQYDVQQD
      ExpMZXQncyBFbmNyeXB0IEF1dGhvcml0eSBYMzAeFw0xODA4MTYxMzU0MjJaFw0x
      ODExMTQxMzU0MjJaMBUxEzARBgNVBAMTCmNhZG1hcy5uZXQwggEiMA0GCSqGSIb3
      DQEBAQUAA4IBDwAwggEKAoIBAQC2AstjKYCPmUDDWG7RCBxwOUMgN0HegUoEuVPT
      7Nxift5+NuNFGkTrCMFjNxDkkxAPT9Rwkoadc+T0eMEZ6O0bBrcaQw/Ni/qxg0eM
      UaiNAbXQXOylr0u/JxhfXvrEdJVgTzrz8K1htfEnug+nauT2xtexzAWfvByI/yaR
      oqZ+qUPQiIb16FSdMheEqHOjJiF0UNMRf17mxE6AIFkAWgb2bCBcvFlY6nb/lAqx
      Mx5SHKiJsELtL7SpYtWLEAihKyMO5Ig9bQmjM6p0QMbO98/16g9yFc7bjWbtQ2rv
      q0rGn9sNiP2MzZAYolktiXfAzSHSDYE0Ijs6PSt37CO6eJkrAgMBAAGjggNXMIID
      UzAOBgNVHQ8BAf8EBAMCBaAwHQYDVR0lBBYwFAYIKwYBBQUHAwEGCCsGAQUFBwMC
      MAwGA1UdEwEB/wQCMAAwHQYDVR0OBBYEFOIwb12QSq64OzhBXx8n5gMXH8DaMB8G
      A1UdIwQYMBaAFKhKamMEfd265tE5t6ZFZe/zqOyhMG8GCCsGAQUFBwEBBGMwYTAu
      BggrBgEFBQcwAYYiaHR0cDovL29jc3AuaW50LXgzLmxldHNlbmNyeXB0Lm9yZzAv
      BggrBgEFBQcwAoYjaHR0cDovL2NlcnQuaW50LXgzLmxldHNlbmNyeXB0Lm9yZy8w
      WgYDVR0RBFMwUYIKY2FkbWFzLm5ldIIzY2FkbWFzYXBwLnJhYXB2ZHpjcXUuZXUt
      d2VzdC0xLmVsYXN0aWNiZWFuc3RhbGsuY29tgg53d3cuY2FkbWFzLm5ldDCB/gYD
      VR0gBIH2MIHzMAgGBmeBDAECATCB5gYLKwYBBAGC3xMBAQEwgdYwJgYIKwYBBQUH
      AgEWGmh0dHA6Ly9jcHMubGV0c2VuY3J5cHQub3JnMIGrBggrBgEFBQcCAjCBngyB
      m1RoaXMgQ2VydGlmaWNhdGUgbWF5IG9ubHkgYmUgcmVsaWVkIHVwb24gYnkgUmVs
      eWluZyBQYXJ0aWVzIGFuZCBvbmx5IGluIGFjY29yZGFuY2Ugd2l0aCB0aGUgQ2Vy
      dGlmaWNhdGUgUG9saWN5IGZvdW5kIGF0IGh0dHBzOi8vbGV0c2VuY3J5cHQub3Jn
      L3JlcG9zaXRvcnkvMIIBBAYKKwYBBAHWeQIEAgSB9QSB8gDwAHYAKTxRllTIOWW6
      qlD8WAfUt2+/WHopctykwwz05UVH9HgAAAFlQzr32wAABAMARzBFAiEA6RzS8YPN
      Igzl9qyTOxPJtTPC8eqzB9rXw3rFIM5fcmACIBETdCTq+BygZrdIjuyAaSmduObA
      Czd14ZRYzdIWrK5BAHYAwRZK4Kdy0tQ5LcgKwQdw1PDEm96ZGkhAwfoHUWT2M2AA
      AAFlQzr52QAABAMARzBFAiB+V2ZqnEDVlGk6vbmemyiFeBOqKOZdoOKrMmnKnXtC
      LAIhAPnKSzkQBTY7UMqal8YD4JU3IoJsNHYPrapv8SP3l44bMA0GCSqGSIb3DQEB
      CwUAA4IBAQB2hZCfBfPzszf5OtQljv4MRVZY9sK6T5FiIzlSP8Nfjc2SKWImC3Kg
      3ySw3QBlFL3CuENJmQgPMIGbCpj6wx/IevGcZD4tFxKZB9fLRdEM0iXzwS+miWXf
      0x6dn2m4hYoX9oL/jF5t3Y4LaLaBa+gGKCfeTaB42MSugmD19ATFztrDZKcMQ5Rs
      ZbiXMal8as23XTyom4skpZWxcCI3AogbTKW9ohbEiyv4l5wVGhJHilgL6+3KxV+R
      tmf5Kxpl4d/HBjqnfiyvz27NoRweNz5igKDxbFWsfJQFCkhxoUNSf13yivOlI0lS
      YUasn2JIIoF7oK33IO6z3fpajyfxmoBm
      -----END CERTIFICATE-----
      -----BEGIN CERTIFICATE-----
      MIIEkjCCA3qgAwIBAgIQCgFBQgAAAVOFc2oLheynCDANBgkqhkiG9w0BAQsFADA/
      MSQwIgYDVQQKExtEaWdpdGFsIFNpZ25hdHVyZSBUcnVzdCBDby4xFzAVBgNVBAMT
      DkRTVCBSb290IENBIFgzMB4XDTE2MDMxNzE2NDA0NloXDTIxMDMxNzE2NDA0Nlow
      SjELMAkGA1UEBhMCVVMxFjAUBgNVBAoTDUxldCdzIEVuY3J5cHQxIzAhBgNVBAMT
      GkxldCdzIEVuY3J5cHQgQXV0aG9yaXR5IFgzMIIBIjANBgkqhkiG9w0BAQEFAAOC
      AQ8AMIIBCgKCAQEAnNMM8FrlLke3cl03g7NoYzDq1zUmGSXhvb418XCSL7e4S0EF
      q6meNQhY7LEqxGiHC6PjdeTm86dicbp5gWAf15Gan/PQeGdxyGkOlZHP/uaZ6WA8
      SMx+yk13EiSdRxta67nsHjcAHJyse6cF6s5K671B5TaYucv9bTyWaN8jKkKQDIZ0
      Z8h/pZq4UmEUEz9l6YKHy9v6Dlb2honzhT+Xhq+w3Brvaw2VFn3EK6BlspkENnWA
      a6xK8xuQSXgvopZPKiAlKQTGdMDQMc2PMTiVFrqoM7hD8bEfwzB/onkxEz0tNvjj
      /PIzark5McWvxI0NHWQWM6r6hCm21AvA2H3DkwIDAQABo4IBfTCCAXkwEgYDVR0T
      AQH/BAgwBgEB/wIBADAOBgNVHQ8BAf8EBAMCAYYwfwYIKwYBBQUHAQEEczBxMDIG
      CCsGAQUFBzABhiZodHRwOi8vaXNyZy50cnVzdGlkLm9jc3AuaWRlbnRydXN0LmNv
      bTA7BggrBgEFBQcwAoYvaHR0cDovL2FwcHMuaWRlbnRydXN0LmNvbS9yb290cy9k
      c3Ryb290Y2F4My5wN2MwHwYDVR0jBBgwFoAUxKexpHsscfrb4UuQdf/EFWCFiRAw
      VAYDVR0gBE0wSzAIBgZngQwBAgEwPwYLKwYBBAGC3xMBAQEwMDAuBggrBgEFBQcC
      ARYiaHR0cDovL2Nwcy5yb290LXgxLmxldHNlbmNyeXB0Lm9yZzA8BgNVHR8ENTAz
      MDGgL6AthitodHRwOi8vY3JsLmlkZW50cnVzdC5jb20vRFNUUk9PVENBWDNDUkwu
      Y3JsMB0GA1UdDgQWBBSoSmpjBH3duubRObemRWXv86jsoTANBgkqhkiG9w0BAQsF
      AAOCAQEA3TPXEfNjWDjdGBX7CVW+dla5cEilaUcne8IkCJLxWh9KEik3JHRRHGJo
      uM2VcGfl96S8TihRzZvoroed6ti6WqEBmtzw3Wodatg+VyOeph4EYpr/1wXKtx8/
      wApIvJSwtmVi4MFU5aMqrSDE6ea73Mj2tcMyo5jMd6jmeWUHK8so/joWUoHOUgwu
      X4Po1QYz+3dszkDqMp4fklxBwXRsW10KXzPMTZ+sOPAveyxindmjkW8lGy+QsRlG
      PfZ+G6Z6h7mjem0Y+iWlkYcV4PIWL1iwBi8saCbGS5jN2p8M+X+Q7UNKEkROb3N6
      KOqkqm57TH2H3eDJAkSnh6/DNFu0Qg==
      -----END CERTIFICATE-----


  /etc/letsencrypt/live/cadmas.net/privkey.pem:
    mode: "000400"
    owner: root
    group: root
    content: |
      -----BEGIN PRIVATE KEY-----
      MIIEvQIBADANBgkqhkiG9w0BAQEFAASCBKcwggSjAgEAAoIBAQC2AstjKYCPmUDD
      WG7RCBxwOUMgN0HegUoEuVPT7Nxift5+NuNFGkTrCMFjNxDkkxAPT9Rwkoadc+T0
      eMEZ6O0bBrcaQw/Ni/qxg0eMUaiNAbXQXOylr0u/JxhfXvrEdJVgTzrz8K1htfEn
      ug+nauT2xtexzAWfvByI/yaRoqZ+qUPQiIb16FSdMheEqHOjJiF0UNMRf17mxE6A
      IFkAWgb2bCBcvFlY6nb/lAqxMx5SHKiJsELtL7SpYtWLEAihKyMO5Ig9bQmjM6p0
      QMbO98/16g9yFc7bjWbtQ2rvq0rGn9sNiP2MzZAYolktiXfAzSHSDYE0Ijs6PSt3
      7CO6eJkrAgMBAAECggEBALAl8DTd+5/+D6F+unDuyqcJpB9Pmx3+PmZn/esCNx/T
      7Px1nmpITB6zcIXWyzCL62UGO3FfPYywlwrKuweaV65qR1bRREAHku2tQddZSCh/
      WTh4VkbbahFrgrj6MPNkaRS2WTWw3fvMm8F43qGGYGU8d4+JBoBbC7rCRM95fGzj
      PdsdYdfJOfFOwaUJmL/QVDPtESLkE5GgrBq0MQYsiWHdlj9UuSAYoIjJz8Vho0We
      svLelovf8AuDHj4woJNRGs9n2mZT16rpBB86DoFAcNS0NH9XeAtJp14KSEoERhQR
      uTY69J0ioh0hTo8WpzHVsCpd505LzXFQUq0FjXJEg1ECgYEA3Yn2mneGxjrwVic/
      ex6fIoVeOx78rzJakwESaB8NeIpHwYvDUX/5cDU6+H54lxd/LpQRM1OyM8/JhgJb
      GKooIkFZW7lrgWKyOZE2Jkl89e+MhuSWrM9Oa4h+S1ylgjgHR/S/wQVO4CmGPrXe
      tM4Ag8jYsI0h0lSexfwZxE7WM6cCgYEA0lLDLX75X/kzKBZFY3SD8cQqt3ZNvNTn
      SJSEjL+hfvQ/M9v+6eEernTeLsUG8F3shvEN4ZXEVLRKp3o+4BxldB+GNcxVbb9L
      yaJEkmGgZWPlZSYlVH08kuO774Sio0kNlkDZRdxQilVwFwLIKPk4qpitQa5oV8uL
      u6rRf8BKLt0CgYAtyJ1WPu1zeirBI0tTPnjUwYs/3J+L9XQSfV44dnJqPumlbiTn
      avM55UZSpJB3aTu3fJIxcVKaso6LS2FYL5IrwiWddyxoiOUcUI5IS1ev29nG5ubc
      v9sNDiBLotHxn3KhxEr8sQQj/3Dm9N8Zrpkcox1lH0WmGibV88u/biuGcQKBgA4t
      qh6tCp6frAUtyyuzNRndQYvwm7j5GUZZTL44ROjMCl6ym/KkTG8yTbAVdCxMCJ/o
      LCli8UNMjCPSJ97vyx8S6PdDeRbW6IMFP14m2qs7GsHA2o9hie3VEFxLMrOTPyk7
      4enFumA49j923ot0kY9ej394BGy2ugrCrzDPg7C5AoGAfggsWz0MtY0CxjnZjiXx
      FNJTVRm5EDPTupNcIBXf66fHzZfdAaGS3VhmkbuqwfRpuxbox2IW/IN7rtqSL0Rs
      sfV7dN4YKcIF7KreL3+ZV/Eav/IUd6buF+A2ACSkV9NynI6NirYKBspV25M6YGMs
      sCSaw+YCzDG1aqdWjMWoxrg=
      -----END PRIVATE KEY-----
